---
title: "week_3_activity_3"
author: "Calum Smith"
date: "2026-01-26"
output: html_document
---

```{r}
renv::init()
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
library(dplyr)
library(gtsummary)
library(e1071)
library(gt)
```


```{r}
# Read the data into R
df <- read.csv("data/st422_week3_subscription_v1.csv")
```

```{r}
# Column variables
group_var <- 'region'

# Row Variables
vars <- names(select(df, -"region"))

# Building the table 1
table1 <- df %>%
  select(all_of(c(group_var, vars))) %>%
    tbl_summary(by = all_of(group_var),
    statistic = list(
      # Specific statistics
      all_continuous() ~ "{median} ({p25}, {p75})",
      all_categorical() ~ "{n} ({p}%)"),
      # Explicitly include the missing data
      missing = "ifany",
      missing_text = "(Missing)",
      # Statistics about the missing data
      missing_stat = "{N_miss} ({p_miss}%)"
    
    ) %>%
  add_overall(last = FALSE) %>%
  add_n() %>%
  add_stat_label(
    location = "row") %>%
  modify_header(label ~ "**Variable**") %>%
  modify_caption("**Table 1. Region Characteristics**") %>%

table1 %>% 
  as_gt() %>%
  tab_options(
    table.font.size = px(9),
    table.width = pct(100)
  )

```


```{r}
renv::snapshot()
```







